[gd_scene load_steps=43 format=3 uid="uid://cx5mk2aylf5te"]

[ext_resource type="Script" uid="uid://dyq1wlk6sb0q4" path="res://entities/enemy/enemy.gd" id="1_dt443"]
[ext_resource type="Resource" uid="uid://chjmobof5rfmv" path="res://entities/enemy/resources/tiki_eraser_01.tres" id="2_n8b7o"]
[ext_resource type="Texture2D" uid="uid://bsh0j4euvqbgo" path="res://assets/enemies/tiki_eraser_01/shoot/tiki_eraser_001_shoot_00006.png" id="3_1lqus"]
[ext_resource type="Texture2D" uid="uid://kdchagk1ccs7" path="res://assets/enemies/tiki_eraser_01/shoot/tiki_eraser_001_shoot_00007.png" id="4_2fo61"]
[ext_resource type="Texture2D" uid="uid://c4eons7gwcyy7" path="res://assets/enemies/tiki_eraser_01/shoot/tiki_eraser_001_shoot_00008.png" id="5_dtkp3"]
[ext_resource type="Script" uid="uid://xi8j357bo6xr" path="res://addons/godot_state_charts/state_chart.gd" id="6_721x4"]
[ext_resource type="Texture2D" uid="uid://d1w7akn4gmafa" path="res://assets/enemies/tiki_eraser_01/shoot/tiki_eraser_001_shoot_00009.png" id="6_m56ec"]
[ext_resource type="Texture2D" uid="uid://korejyy0tcu7" path="res://assets/enemies/tiki_eraser_01/shoot/tiki_eraser_001_shoot_00010.png" id="7_ag8el"]
[ext_resource type="Script" uid="uid://erpnkwrvfgbf" path="res://addons/godot_state_charts/compound_state.gd" id="7_eaj7m"]
[ext_resource type="Script" uid="uid://c54wba7xahabr" path="res://addons/godot_state_charts/atomic_state.gd" id="8_a8fs5"]
[ext_resource type="Texture2D" uid="uid://bnpcs467xk7ml" path="res://assets/enemies/tiki_eraser_01/shoot/tiki_eraser_001_shoot_00011.png" id="8_kvmxw"]
[ext_resource type="Script" uid="uid://2iiyj3enpprf" path="res://addons/godot_state_charts/transition.gd" id="9_eaj7m"]
[ext_resource type="Texture2D" uid="uid://iwf6sbfkibga" path="res://assets/enemies/tiki_eraser_01/shoot/tiki_eraser_001_shoot_00012.png" id="9_fxw2g"]
[ext_resource type="Texture2D" uid="uid://cf3725mqj8x01" path="res://assets/enemies/tiki_eraser_01/shoot/tiki_eraser_001_shoot_00013.png" id="10_d8pt4"]
[ext_resource type="Texture2D" uid="uid://dnm0h6rv0h6m4" path="res://assets/enemies/tiki_eraser_01/shoot/tiki_eraser_001_shoot_00014.png" id="11_d0pvf"]
[ext_resource type="Texture2D" uid="uid://b638jos1eyllu" path="res://assets/enemies/tiki_eraser_01/shoot/tiki_eraser_001_shoot_00015.png" id="12_d8vfj"]
[ext_resource type="Texture2D" uid="uid://cnxkv8fkaj3f6" path="res://assets/enemies/tiki_eraser_01/shoot/tiki_eraser_001_shoot_00016.png" id="13_8uinu"]
[ext_resource type="Texture2D" uid="uid://bjjksmid30pns" path="res://assets/enemies/tiki_eraser_01/shoot/tiki_eraser_001_shoot_00017.png" id="14_26jx0"]
[ext_resource type="Texture2D" uid="uid://lqumhrngil1w" path="res://assets/enemies/tiki_eraser_01/shoot/tiki_eraser_001_shoot_00018.png" id="15_77u4a"]
[ext_resource type="Texture2D" uid="uid://ckhkfs3n2euwv" path="res://assets/enemies/tiki_eraser_01/shoot/tiki_eraser_001_shoot_00019.png" id="16_6wf1i"]
[ext_resource type="Texture2D" uid="uid://cu5ogxposw73o" path="res://assets/enemies/shared/death/Enemy_DEATH_00000.png" id="17_1lqus"]
[ext_resource type="Texture2D" uid="uid://b8ui4ojf1w2pv" path="res://assets/enemies/shared/death/Enemy_DEATH_00001.png" id="18_2fo61"]
[ext_resource type="Texture2D" uid="uid://8kuas6xems46" path="res://assets/enemies/shared/death/Enemy_DEATH_00002.png" id="19_dtkp3"]
[ext_resource type="Texture2D" uid="uid://clxvwugsflsua" path="res://assets/enemies/shared/death/Enemy_DEATH_00003.png" id="20_m56ec"]
[ext_resource type="Texture2D" uid="uid://bw4ek4622l4qp" path="res://assets/enemies/shared/death/Enemy_DEATH_00004.png" id="21_ag8el"]
[ext_resource type="Texture2D" uid="uid://cd5315hre4xuc" path="res://assets/enemies/shared/death/Enemy_DEATH_00005.png" id="22_kvmxw"]
[ext_resource type="Texture2D" uid="uid://6agt053n4pg5" path="res://assets/enemies/shared/death/Enemy_DEATH_00006.png" id="23_fxw2g"]
[ext_resource type="Texture2D" uid="uid://c7jqddvikptnp" path="res://assets/enemies/shared/death/Enemy_DEATH_00007.png" id="24_d8pt4"]
[ext_resource type="Texture2D" uid="uid://tlblckeo0mx4" path="res://assets/enemies/shared/death/Enemy_DEATH_00008.png" id="25_d0pvf"]
[ext_resource type="Texture2D" uid="uid://4midewhvqr83" path="res://assets/enemies/shared/death/Enemy_DEATH_00009.png" id="26_d8vfj"]
[ext_resource type="Texture2D" uid="uid://eyy81fetlu63" path="res://assets/enemies/shared/death/Enemy_DEATH_00010.png" id="27_8uinu"]
[ext_resource type="Texture2D" uid="uid://gd5sctfpnic5" path="res://assets/enemies/shared/death/Enemy_DEATH_00011.png" id="28_26jx0"]
[ext_resource type="Texture2D" uid="uid://brx8e2ee0kolx" path="res://assets/enemies/tiki_eraser_01/hit/tiki_eraser_001_hit_00011.png" id="29_ciri5"]
[ext_resource type="Texture2D" uid="uid://dybh4d25a26uy" path="res://assets/enemies/tiki_eraser_01/hit/tiki_eraser_001_hit_00012.png" id="30_gcjnm"]
[ext_resource type="Texture2D" uid="uid://btghwj16jc4en" path="res://assets/enemies/tiki_eraser_01/hit/tiki_eraser_001_hit_00013.png" id="31_w8lc3"]
[ext_resource type="Texture2D" uid="uid://byodppfiwtuie" path="res://assets/enemies/tiki_eraser_01/hit/tiki_eraser_001_hit_00014.png" id="32_0bs5w"]
[ext_resource type="Texture2D" uid="uid://bt5arv5a0gegr" path="res://assets/enemies/tiki_eraser_01/hit/tiki_eraser_001_hit_00015.png" id="33_vtmcy"]
[ext_resource type="Texture2D" uid="uid://rpthgw4qwqjj" path="res://assets/enemies/tiki_eraser_01/hit/tiki_eraser_001_hit_00016.png" id="34_1dcmx"]
[ext_resource type="Texture2D" uid="uid://b2xs1dj6dsp41" path="res://assets/enemies/tiki_eraser_01/hit/tiki_eraser_001_hit_00017.png" id="35_18xtp"]
[ext_resource type="Texture2D" uid="uid://cmhl6h7d5wgbd" path="res://assets/enemies/tiki_eraser_01/hit/tiki_eraser_001_hit_00018.png" id="36_srxxf"]

[sub_resource type="CylinderShape3D" id="CylinderShape3D_h5njh"]
radius = 0.8

[sub_resource type="SpriteFrames" id="SpriteFrames_3y65k"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("3_1lqus")
}, {
"duration": 1.0,
"texture": ExtResource("4_2fo61")
}, {
"duration": 1.0,
"texture": ExtResource("5_dtkp3")
}, {
"duration": 1.0,
"texture": ExtResource("6_m56ec")
}, {
"duration": 1.0,
"texture": ExtResource("7_ag8el")
}, {
"duration": 1.0,
"texture": ExtResource("8_kvmxw")
}, {
"duration": 1.0,
"texture": ExtResource("9_fxw2g")
}, {
"duration": 1.0,
"texture": ExtResource("10_d8pt4")
}, {
"duration": 1.0,
"texture": ExtResource("11_d0pvf")
}, {
"duration": 1.0,
"texture": ExtResource("12_d8vfj")
}, {
"duration": 1.0,
"texture": ExtResource("13_8uinu")
}, {
"duration": 1.0,
"texture": ExtResource("14_26jx0")
}, {
"duration": 1.0,
"texture": ExtResource("15_77u4a")
}, {
"duration": 1.0,
"texture": ExtResource("16_6wf1i")
}],
"loop": false,
"name": &"attack",
"speed": 12.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("17_1lqus")
}, {
"duration": 1.0,
"texture": ExtResource("18_2fo61")
}, {
"duration": 1.0,
"texture": ExtResource("19_dtkp3")
}, {
"duration": 1.0,
"texture": ExtResource("20_m56ec")
}, {
"duration": 1.0,
"texture": ExtResource("21_ag8el")
}, {
"duration": 1.0,
"texture": ExtResource("22_kvmxw")
}, {
"duration": 1.0,
"texture": ExtResource("23_fxw2g")
}, {
"duration": 1.0,
"texture": ExtResource("24_d8pt4")
}, {
"duration": 1.0,
"texture": ExtResource("25_d0pvf")
}, {
"duration": 1.0,
"texture": ExtResource("26_d8vfj")
}, {
"duration": 1.0,
"texture": ExtResource("27_8uinu")
}, {
"duration": 1.0,
"texture": ExtResource("28_26jx0")
}],
"loop": false,
"name": &"death",
"speed": 12.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("3_1lqus")
}, {
"duration": 1.0,
"texture": ExtResource("16_6wf1i")
}],
"loop": true,
"name": &"default",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("29_ciri5")
}, {
"duration": 1.0,
"texture": ExtResource("30_gcjnm")
}, {
"duration": 1.0,
"texture": ExtResource("31_w8lc3")
}, {
"duration": 1.0,
"texture": ExtResource("32_0bs5w")
}, {
"duration": 1.0,
"texture": ExtResource("33_vtmcy")
}, {
"duration": 1.0,
"texture": ExtResource("34_1dcmx")
}, {
"duration": 1.0,
"texture": ExtResource("35_18xtp")
}, {
"duration": 1.0,
"texture": ExtResource("36_srxxf")
}],
"loop": false,
"name": &"pain",
"speed": 12.0
}]

[node name="Enemy" type="CharacterBody3D" groups=["damageable", "enemies"]]
collision_mask = 7
script = ExtResource("1_dt443")
resource = ExtResource("2_n8b7o")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CylinderShape3D_h5njh")
debug_color = Color(0.956354, 4.81307e-07, 0.538377, 0.42)

[node name="AnimatedSprite3D" type="AnimatedSprite3D" parent="."]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 0, 1.28, 0)
billboard = 2
texture_filter = 2
sprite_frames = SubResource("SpriteFrames_3y65k")
autoplay = "default"

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]
path_desired_distance = 30.0
avoidance_enabled = true

[node name="SightRayCast" type="RayCast3D" parent="."]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, -1, -8.74228e-08, 0, 8.74228e-08, -1, 0, 1.05982, 0)
enabled = false
target_position = Vector3(0, 0, 100)
debug_shape_custom_color = Color(0, 0.59079, 0.744833, 1)

[node name="AttackRayCast" type="RayCast3D" parent="."]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, -1, -8.74228e-08, 0, 8.74228e-08, -1, 0, 0.5, -0.5)
enabled = false
target_position = Vector3(0, 0, 30)
debug_shape_custom_color = Color(1, 0, 0, 1)

[node name="StateChart" type="Node" parent="."]
script = ExtResource("6_721x4")
metadata/_custom_type_script = "uid://xi8j357bo6xr"

[node name="RootState" type="Node" parent="StateChart"]
script = ExtResource("7_eaj7m")
initial_state = NodePath("AliveState")

[node name="AliveState" type="Node" parent="StateChart/RootState"]
script = ExtResource("7_eaj7m")
initial_state = NodePath("IdleState")

[node name="IdleState" type="Node" parent="StateChart/RootState/AliveState"]
unique_name_in_owner = true
script = ExtResource("8_a8fs5")

[node name="Awaken" type="Node" parent="StateChart/RootState/AliveState/IdleState"]
script = ExtResource("9_eaj7m")
to = NodePath("../../ActiveState")
event = &"awaken"
delay_in_seconds = "0.0"

[node name="ActiveState" type="Node" parent="StateChart/RootState/AliveState"]
unique_name_in_owner = true
script = ExtResource("7_eaj7m")
initial_state = NodePath("ChaseState")

[node name="ChaseState" type="Node" parent="StateChart/RootState/AliveState/ActiveState"]
unique_name_in_owner = true
script = ExtResource("8_a8fs5")

[node name="Attack" type="Node" parent="StateChart/RootState/AliveState/ActiveState/ChaseState"]
script = ExtResource("9_eaj7m")
to = NodePath("../../AttackState")
event = &"attack"
delay_in_seconds = "0.0"

[node name="AttackState" type="Node" parent="StateChart/RootState/AliveState/ActiveState"]
unique_name_in_owner = true
script = ExtResource("8_a8fs5")

[node name="Chase" type="Node" parent="StateChart/RootState/AliveState/ActiveState/AttackState"]
script = ExtResource("9_eaj7m")
to = NodePath("../../ChaseState")
event = &"chase"
delay_in_seconds = "0.0"

[node name="PainState" type="Node" parent="StateChart/RootState/AliveState"]
unique_name_in_owner = true
script = ExtResource("8_a8fs5")

[node name="Active" type="Node" parent="StateChart/RootState/AliveState/PainState"]
script = ExtResource("9_eaj7m")
to = NodePath("../../ActiveState/ChaseState")
event = &"active"
delay_in_seconds = "0.0"

[node name="Death" type="Node" parent="StateChart/RootState/AliveState"]
script = ExtResource("9_eaj7m")
to = NodePath("../../DeathState")
event = &"death"
delay_in_seconds = "0.0"

[node name="Pain" type="Node" parent="StateChart/RootState/AliveState"]
script = ExtResource("9_eaj7m")
to = NodePath("../PainState")
event = &"pain"
delay_in_seconds = "0.0"

[node name="DeathState" type="Node" parent="StateChart/RootState"]
unique_name_in_owner = true
script = ExtResource("8_a8fs5")

[node name="ProjectileSpawnPoint" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.68824, -0.75)

[node name="AttackTimer" type="Timer" parent="."]
wait_time = 2.0
one_shot = true
autostart = true

[node name="RoamTimer" type="Timer" parent="."]
one_shot = true

[connection signal="animation_finished" from="AnimatedSprite3D" to="." method="_on_animated_sprite_3d_animation_finished"]
[connection signal="frame_changed" from="AnimatedSprite3D" to="." method="_on_animated_sprite_3d_frame_changed"]
[connection signal="velocity_computed" from="NavigationAgent3D" to="." method="_on_navigation_agent_3d_velocity_computed"]
[connection signal="state_entered" from="StateChart/RootState/AliveState/IdleState" to="." method="_on_idle_state_state_entered"]
[connection signal="state_exited" from="StateChart/RootState/AliveState/IdleState" to="." method="_on_idle_state_state_exited"]
[connection signal="state_physics_processing" from="StateChart/RootState/AliveState/IdleState" to="." method="_on_idle_state_state_physics_processing"]
[connection signal="state_entered" from="StateChart/RootState/AliveState/ActiveState/ChaseState" to="." method="_on_chase_state_state_entered"]
[connection signal="state_physics_processing" from="StateChart/RootState/AliveState/ActiveState/ChaseState" to="." method="_on_chase_state_state_physics_processing"]
[connection signal="state_entered" from="StateChart/RootState/AliveState/ActiveState/AttackState" to="." method="_on_attack_state_state_entered"]
[connection signal="state_exited" from="StateChart/RootState/AliveState/ActiveState/AttackState" to="." method="_on_attack_state_state_exited"]
[connection signal="state_physics_processing" from="StateChart/RootState/AliveState/ActiveState/AttackState" to="." method="_on_attack_state_state_physics_processing"]
[connection signal="state_entered" from="StateChart/RootState/AliveState/PainState" to="." method="_on_pain_state_state_entered"]
[connection signal="state_entered" from="StateChart/RootState/DeathState" to="." method="_on_death_state_state_entered"]
[connection signal="timeout" from="AttackTimer" to="." method="_on_attack_timer_timeout"]
[connection signal="timeout" from="RoamTimer" to="." method="_on_roam_timer_timeout"]
