[gd_scene load_steps=49 format=3 uid="uid://cx5mk2aylf5te"]

[ext_resource type="Script" uid="uid://dyq1wlk6sb0q4" path="res://entities/enemy/enemy.gd" id="1_dt443"]
[ext_resource type="Resource" uid="uid://cv8d8rwsh3weu" path="res://entities/enemy/resources/tiki_mug_01.tres" id="2_kvmxw"]
[ext_resource type="Texture2D" uid="uid://duro6eb53yjxr" path="res://assets/enemies/tiki_mug_01/shoot/tiki_mug_001_jump_00004.png" id="3_fxw2g"]
[ext_resource type="Texture2D" uid="uid://d3q4wo43pwfda" path="res://assets/enemies/tiki_mug_01/shoot/tiki_mug_001_jump_00005.png" id="4_d8pt4"]
[ext_resource type="Texture2D" uid="uid://c4bthtvpgvrvl" path="res://assets/enemies/tiki_mug_01/shoot/tiki_mug_001_jump_00006.png" id="5_d0pvf"]
[ext_resource type="Script" uid="uid://xi8j357bo6xr" path="res://addons/godot_state_charts/state_chart.gd" id="6_721x4"]
[ext_resource type="Texture2D" uid="uid://d16w61e0fk73h" path="res://assets/enemies/tiki_mug_01/shoot/tiki_mug_001_jump_00007.png" id="6_d8vfj"]
[ext_resource type="Texture2D" uid="uid://c0nugyj1g374f" path="res://assets/enemies/tiki_mug_01/shoot/tiki_mug_001_jump_00008.png" id="7_8uinu"]
[ext_resource type="Script" uid="uid://erpnkwrvfgbf" path="res://addons/godot_state_charts/compound_state.gd" id="7_eaj7m"]
[ext_resource type="Texture2D" uid="uid://b4upu1s3wdasg" path="res://assets/enemies/tiki_mug_01/shoot/tiki_mug_001_jump_00009.png" id="8_26jx0"]
[ext_resource type="Script" uid="uid://c54wba7xahabr" path="res://addons/godot_state_charts/atomic_state.gd" id="8_a8fs5"]
[ext_resource type="Texture2D" uid="uid://bd2fgco5dlv0i" path="res://assets/enemies/tiki_mug_01/shoot/tiki_mug_001_jump_00010.png" id="9_77u4a"]
[ext_resource type="Script" uid="uid://2iiyj3enpprf" path="res://addons/godot_state_charts/transition.gd" id="9_eaj7m"]
[ext_resource type="Texture2D" uid="uid://nwbggty7qygc" path="res://assets/enemies/tiki_mug_01/shoot/tiki_mug_001_jump_00011.png" id="10_6wf1i"]
[ext_resource type="Texture2D" uid="uid://cgrju885tuuo0" path="res://assets/enemies/tiki_mug_01/shoot/tiki_mug_001_jump_00012.png" id="11_ciri5"]
[ext_resource type="Texture2D" uid="uid://bg08nps14xxkc" path="res://assets/enemies/tiki_mug_01/shoot/tiki_mug_001_jump_00013.png" id="12_gcjnm"]
[ext_resource type="Texture2D" uid="uid://thnrvmjbvxl4" path="res://assets/enemies/tiki_mug_01/shoot/tiki_mug_001_jump_00014.png" id="13_w8lc3"]
[ext_resource type="Texture2D" uid="uid://cl1hs6tb7gqfs" path="res://assets/enemies/tiki_mug_01/shoot/tiki_mug_001_jump_00015.png" id="14_0bs5w"]
[ext_resource type="Texture2D" uid="uid://e2mmcxy6ghx2" path="res://assets/enemies/tiki_mug_01/shoot/tiki_mug_001_jump_00016.png" id="15_vtmcy"]
[ext_resource type="Texture2D" uid="uid://b4m0seak3dr8p" path="res://assets/enemies/tiki_mug_01/shoot/tiki_mug_001_jump_00017.png" id="16_1dcmx"]
[ext_resource type="Texture2D" uid="uid://cu5ogxposw73o" path="res://assets/enemies/shared/death/Enemy_DEATH_00000.png" id="17_1lqus"]
[ext_resource type="Texture2D" uid="uid://8m7fp3wqlcb4" path="res://assets/enemies/tiki_mug_01/shoot/tiki_mug_001_jump_00018.png" id="17_18xtp"]
[ext_resource type="Texture2D" uid="uid://b8ui4ojf1w2pv" path="res://assets/enemies/shared/death/Enemy_DEATH_00001.png" id="18_2fo61"]
[ext_resource type="Texture2D" uid="uid://hm061oi4o1us" path="res://assets/enemies/tiki_mug_01/shoot/tiki_mug_001_jump_00019.png" id="18_srxxf"]
[ext_resource type="Texture2D" uid="uid://8kuas6xems46" path="res://assets/enemies/shared/death/Enemy_DEATH_00002.png" id="19_dtkp3"]
[ext_resource type="Texture2D" uid="uid://ke7mt2apyolh" path="res://assets/enemies/tiki_mug_01/shoot/tiki_mug_001_jump_00020.png" id="19_ev3mc"]
[ext_resource type="Texture2D" uid="uid://c18b50knfr5cr" path="res://assets/enemies/tiki_mug_01/shoot/tiki_mug_001_jump_00021.png" id="20_gn17a"]
[ext_resource type="Texture2D" uid="uid://clxvwugsflsua" path="res://assets/enemies/shared/death/Enemy_DEATH_00003.png" id="20_m56ec"]
[ext_resource type="Texture2D" uid="uid://bw4ek4622l4qp" path="res://assets/enemies/shared/death/Enemy_DEATH_00004.png" id="21_ag8el"]
[ext_resource type="Texture2D" uid="uid://r5qm766n80ss" path="res://assets/enemies/tiki_mug_01/shoot/tiki_mug_001_jump_00022.png" id="21_eamb4"]
[ext_resource type="Texture2D" uid="uid://ba3s0i8xhjdg0" path="res://assets/enemies/tiki_mug_01/shoot/tiki_mug_001_jump_00023.png" id="22_3lakb"]
[ext_resource type="Texture2D" uid="uid://cd5315hre4xuc" path="res://assets/enemies/shared/death/Enemy_DEATH_00005.png" id="22_kvmxw"]
[ext_resource type="Texture2D" uid="uid://6agt053n4pg5" path="res://assets/enemies/shared/death/Enemy_DEATH_00006.png" id="23_fxw2g"]
[ext_resource type="Texture2D" uid="uid://c7jqddvikptnp" path="res://assets/enemies/shared/death/Enemy_DEATH_00007.png" id="24_d8pt4"]
[ext_resource type="Texture2D" uid="uid://tlblckeo0mx4" path="res://assets/enemies/shared/death/Enemy_DEATH_00008.png" id="25_d0pvf"]
[ext_resource type="Texture2D" uid="uid://4midewhvqr83" path="res://assets/enemies/shared/death/Enemy_DEATH_00009.png" id="26_d8vfj"]
[ext_resource type="Texture2D" uid="uid://eyy81fetlu63" path="res://assets/enemies/shared/death/Enemy_DEATH_00010.png" id="27_8uinu"]
[ext_resource type="Texture2D" uid="uid://gd5sctfpnic5" path="res://assets/enemies/shared/death/Enemy_DEATH_00011.png" id="28_26jx0"]
[ext_resource type="Texture2D" uid="uid://bebsd416f2bdm" path="res://assets/enemies/tiki_mug_01/hit/tiki_mug_001_hit_00004.png" id="35_vf2yv"]
[ext_resource type="Texture2D" uid="uid://dy2xmkix6whiq" path="res://assets/enemies/tiki_mug_01/hit/tiki_mug_001_hit_00005.png" id="36_eo1iy"]
[ext_resource type="Texture2D" uid="uid://72kpqih0isq6" path="res://assets/enemies/tiki_mug_01/hit/tiki_mug_001_hit_00006.png" id="37_6ushx"]
[ext_resource type="Texture2D" uid="uid://dyjih7i3hwa6" path="res://assets/enemies/tiki_mug_01/hit/tiki_mug_001_hit_00007.png" id="38_pkuat"]
[ext_resource type="Texture2D" uid="uid://bm7wrgkt5ru6e" path="res://assets/enemies/tiki_mug_01/hit/tiki_mug_001_hit_00008.png" id="39_bpvii"]
[ext_resource type="Texture2D" uid="uid://k0v7tn43tk8u" path="res://assets/enemies/tiki_mug_01/hit/tiki_mug_001_hit_00009.png" id="40_w57ia"]
[ext_resource type="Texture2D" uid="uid://w7lhfvu4sflg" path="res://assets/enemies/tiki_mug_01/hit/tiki_mug_001_hit_00010.png" id="41_ubufk"]
[ext_resource type="Texture2D" uid="uid://djgsxjhs0mff0" path="res://assets/enemies/tiki_mug_01/hit/tiki_mug_001_hit_00011.png" id="42_ylir5"]

[sub_resource type="CylinderShape3D" id="CylinderShape3D_h5njh"]
radius = 0.8

[sub_resource type="SpriteFrames" id="SpriteFrames_yd6c0"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("3_fxw2g")
}, {
"duration": 1.0,
"texture": ExtResource("4_d8pt4")
}, {
"duration": 1.0,
"texture": ExtResource("5_d0pvf")
}, {
"duration": 1.0,
"texture": ExtResource("6_d8vfj")
}, {
"duration": 1.0,
"texture": ExtResource("7_8uinu")
}, {
"duration": 1.0,
"texture": ExtResource("8_26jx0")
}, {
"duration": 1.0,
"texture": ExtResource("9_77u4a")
}, {
"duration": 1.0,
"texture": ExtResource("10_6wf1i")
}, {
"duration": 1.0,
"texture": ExtResource("11_ciri5")
}, {
"duration": 1.0,
"texture": ExtResource("12_gcjnm")
}, {
"duration": 1.0,
"texture": ExtResource("13_w8lc3")
}, {
"duration": 1.0,
"texture": ExtResource("14_0bs5w")
}, {
"duration": 1.0,
"texture": ExtResource("15_vtmcy")
}, {
"duration": 1.0,
"texture": ExtResource("16_1dcmx")
}, {
"duration": 1.0,
"texture": ExtResource("17_18xtp")
}, {
"duration": 1.0,
"texture": ExtResource("18_srxxf")
}, {
"duration": 1.0,
"texture": ExtResource("19_ev3mc")
}, {
"duration": 1.0,
"texture": ExtResource("20_gn17a")
}, {
"duration": 1.0,
"texture": ExtResource("21_eamb4")
}, {
"duration": 1.0,
"texture": ExtResource("22_3lakb")
}],
"loop": false,
"name": &"attack",
"speed": 12.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("17_1lqus")
}, {
"duration": 1.0,
"texture": ExtResource("18_2fo61")
}, {
"duration": 1.0,
"texture": ExtResource("19_dtkp3")
}, {
"duration": 1.0,
"texture": ExtResource("20_m56ec")
}, {
"duration": 1.0,
"texture": ExtResource("21_ag8el")
}, {
"duration": 1.0,
"texture": ExtResource("22_kvmxw")
}, {
"duration": 1.0,
"texture": ExtResource("23_fxw2g")
}, {
"duration": 1.0,
"texture": ExtResource("24_d8pt4")
}, {
"duration": 1.0,
"texture": ExtResource("25_d0pvf")
}, {
"duration": 1.0,
"texture": ExtResource("26_d8vfj")
}, {
"duration": 1.0,
"texture": ExtResource("27_8uinu")
}, {
"duration": 1.0,
"texture": ExtResource("28_26jx0")
}],
"loop": false,
"name": &"death",
"speed": 12.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("3_fxw2g")
}, {
"duration": 1.0,
"texture": ExtResource("4_d8pt4")
}, {
"duration": 1.0,
"texture": ExtResource("5_d0pvf")
}, {
"duration": 1.0,
"texture": ExtResource("6_d8vfj")
}, {
"duration": 1.0,
"texture": ExtResource("7_8uinu")
}, {
"duration": 1.0,
"texture": ExtResource("8_26jx0")
}, {
"duration": 1.0,
"texture": ExtResource("9_77u4a")
}, {
"duration": 1.0,
"texture": ExtResource("10_6wf1i")
}, {
"duration": 1.0,
"texture": ExtResource("11_ciri5")
}, {
"duration": 1.0,
"texture": ExtResource("12_gcjnm")
}, {
"duration": 1.0,
"texture": ExtResource("13_w8lc3")
}, {
"duration": 1.0,
"texture": ExtResource("14_0bs5w")
}, {
"duration": 1.0,
"texture": ExtResource("15_vtmcy")
}, {
"duration": 1.0,
"texture": ExtResource("16_1dcmx")
}, {
"duration": 1.0,
"texture": ExtResource("17_18xtp")
}, {
"duration": 1.0,
"texture": ExtResource("18_srxxf")
}, {
"duration": 1.0,
"texture": ExtResource("19_ev3mc")
}, {
"duration": 1.0,
"texture": ExtResource("20_gn17a")
}, {
"duration": 1.0,
"texture": ExtResource("21_eamb4")
}, {
"duration": 1.0,
"texture": ExtResource("22_3lakb")
}],
"loop": true,
"name": &"default",
"speed": 12.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("35_vf2yv")
}, {
"duration": 1.0,
"texture": ExtResource("36_eo1iy")
}, {
"duration": 1.0,
"texture": ExtResource("37_6ushx")
}, {
"duration": 1.0,
"texture": ExtResource("38_pkuat")
}, {
"duration": 1.0,
"texture": ExtResource("39_bpvii")
}, {
"duration": 1.0,
"texture": ExtResource("40_w57ia")
}, {
"duration": 1.0,
"texture": ExtResource("41_ubufk")
}, {
"duration": 1.0,
"texture": ExtResource("42_ylir5")
}],
"loop": false,
"name": &"pain",
"speed": 12.0
}]

[node name="Enemy" type="CharacterBody3D" groups=["damageable", "enemies"]]
collision_mask = 7
script = ExtResource("1_dt443")
resource = ExtResource("2_kvmxw")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CylinderShape3D_h5njh")
debug_color = Color(0.956354, 4.81307e-07, 0.538377, 0.42)

[node name="AnimatedSprite3D" type="AnimatedSprite3D" parent="."]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 0, 1.28, 0)
offset = Vector2(45, 0)
billboard = 2
texture_filter = 2
sprite_frames = SubResource("SpriteFrames_yd6c0")
animation = &"pain"
autoplay = "default"

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]
path_desired_distance = 30.0
avoidance_enabled = true

[node name="SightRayCast" type="RayCast3D" parent="."]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, -1, -8.74228e-08, 0, 8.74228e-08, -1, 0, 1.05982, 0)
enabled = false
target_position = Vector3(0, 0, 100)
debug_shape_custom_color = Color(0, 0.59079, 0.744833, 1)

[node name="AttackRayCast" type="RayCast3D" parent="."]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, -1, -8.74228e-08, 0, 8.74228e-08, -1, 0, 0.5, -0.5)
enabled = false
target_position = Vector3(0, 0, 30)
debug_shape_custom_color = Color(1, 0, 0, 1)

[node name="StateChart" type="Node" parent="."]
script = ExtResource("6_721x4")
metadata/_custom_type_script = "uid://xi8j357bo6xr"

[node name="RootState" type="Node" parent="StateChart"]
script = ExtResource("7_eaj7m")
initial_state = NodePath("AliveState")

[node name="AliveState" type="Node" parent="StateChart/RootState"]
script = ExtResource("7_eaj7m")
initial_state = NodePath("IdleState")

[node name="IdleState" type="Node" parent="StateChart/RootState/AliveState"]
unique_name_in_owner = true
script = ExtResource("8_a8fs5")

[node name="Awaken" type="Node" parent="StateChart/RootState/AliveState/IdleState"]
script = ExtResource("9_eaj7m")
to = NodePath("../../ActiveState")
event = &"awaken"
delay_in_seconds = "0.0"

[node name="ActiveState" type="Node" parent="StateChart/RootState/AliveState"]
unique_name_in_owner = true
script = ExtResource("7_eaj7m")
initial_state = NodePath("ChaseState")

[node name="ChaseState" type="Node" parent="StateChart/RootState/AliveState/ActiveState"]
unique_name_in_owner = true
script = ExtResource("8_a8fs5")

[node name="Attack" type="Node" parent="StateChart/RootState/AliveState/ActiveState/ChaseState"]
script = ExtResource("9_eaj7m")
to = NodePath("../../AttackState")
event = &"attack"
delay_in_seconds = "0.0"

[node name="AttackState" type="Node" parent="StateChart/RootState/AliveState/ActiveState"]
unique_name_in_owner = true
script = ExtResource("8_a8fs5")

[node name="Chase" type="Node" parent="StateChart/RootState/AliveState/ActiveState/AttackState"]
script = ExtResource("9_eaj7m")
to = NodePath("../../ChaseState")
event = &"chase"
delay_in_seconds = "0.0"

[node name="PainState" type="Node" parent="StateChart/RootState/AliveState"]
unique_name_in_owner = true
script = ExtResource("8_a8fs5")

[node name="Active" type="Node" parent="StateChart/RootState/AliveState/PainState"]
script = ExtResource("9_eaj7m")
to = NodePath("../../ActiveState/ChaseState")
event = &"active"
delay_in_seconds = "0.0"

[node name="Death" type="Node" parent="StateChart/RootState/AliveState"]
script = ExtResource("9_eaj7m")
to = NodePath("../../DeathState")
event = &"death"
delay_in_seconds = "0.0"

[node name="Pain" type="Node" parent="StateChart/RootState/AliveState"]
script = ExtResource("9_eaj7m")
to = NodePath("../PainState")
event = &"pain"
delay_in_seconds = "0.0"

[node name="DeathState" type="Node" parent="StateChart/RootState"]
unique_name_in_owner = true
script = ExtResource("8_a8fs5")

[node name="ProjectileSpawnPoint" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.68824, -0.75)

[node name="AttackTimer" type="Timer" parent="."]
wait_time = 2.0
one_shot = true
autostart = true

[connection signal="animation_finished" from="AnimatedSprite3D" to="." method="_on_animated_sprite_3d_animation_finished"]
[connection signal="frame_changed" from="AnimatedSprite3D" to="." method="_on_animated_sprite_3d_frame_changed"]
[connection signal="velocity_computed" from="NavigationAgent3D" to="." method="_on_navigation_agent_3d_velocity_computed"]
[connection signal="state_entered" from="StateChart/RootState/AliveState/IdleState" to="." method="_on_idle_state_state_entered"]
[connection signal="state_physics_processing" from="StateChart/RootState/AliveState/IdleState" to="." method="_on_idle_state_state_physics_processing"]
[connection signal="state_entered" from="StateChart/RootState/AliveState/ActiveState/ChaseState" to="." method="_on_chase_state_state_entered"]
[connection signal="state_physics_processing" from="StateChart/RootState/AliveState/ActiveState/ChaseState" to="." method="_on_chase_state_state_physics_processing"]
[connection signal="state_entered" from="StateChart/RootState/AliveState/ActiveState/AttackState" to="." method="_on_attack_state_state_entered"]
[connection signal="state_exited" from="StateChart/RootState/AliveState/ActiveState/AttackState" to="." method="_on_attack_state_state_exited"]
[connection signal="state_physics_processing" from="StateChart/RootState/AliveState/ActiveState/AttackState" to="." method="_on_attack_state_state_physics_processing"]
[connection signal="state_entered" from="StateChart/RootState/AliveState/PainState" to="." method="_on_pain_state_state_entered"]
[connection signal="state_entered" from="StateChart/RootState/DeathState" to="." method="_on_death_state_state_entered"]
[connection signal="timeout" from="AttackTimer" to="." method="_on_attack_timer_timeout"]
